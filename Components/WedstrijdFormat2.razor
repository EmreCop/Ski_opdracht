<h3>@Wedstrijd2.WedstrijdName</h3>
<div style="display:flex">
  <RacerSelector Selected="RacerSelected" />
  <button class="btn btn-primary m-1" @onclick="AddRacer">Voeg Racer toe</button>
</div>
<hr />
<table class="table">
  <thead>
    <tr>
      <th>Rugnummer</th>
      <th>Name</th>
      <th>Run 1</th>
      <th>Run 2</th>
    </tr>
  </thead>
  <tbody>
    @foreach (var racer in Wedstrijd2.Racers)
    {
      <tr>
        <td>@racer.Value.Rugnummer</td>
        <td>@racer.Value.FirstName  @racer.Value.LastName</td>
        <td>@racer.Value.Run1</td>
        <td>@racer.Value.Run2</td>

      </tr>
    }
  </tbody>
</table>

<RacerSelector Selected="AddRacer" />

@code {

  [Parameter]
  public Wedstrijd Wedstrijd2 { get; set; } = new();

  Racerlijst Racers = new();
  int RacerID;
 
  void AddRacer()
  {
    foreach (var racer in Racers.Racerlist)
    {
      if (racer.Key == RacerID)
      {
        if (Wedstrijd2.Racers == null)
        {
          Wedstrijd2.Racers = new();
        }
        Wedstrijd2.Racers.Add(RacerID, racer.Value);
      }
    }
  }

  void RacerSelected(int SeletedRacerID) => RacerID = SeletedRacerID;

  void FromJson()
  {
    var filename = @"Racerslijst.json";
    if (File.Exists(filename))
    {
      var jsonstring = File.ReadAllText(filename);
      Racers = JsonSerializer.Deserialize<Racerlijst>(jsonstring)!;
    }
  }



  void GetFastestRuns()
  {
    foreach (var racer in Wedstrijd2.Racers)
    {
      SkiTime[] runs = new SkiTime[] { racer.Value.Run1, racer.Value.Run2, racer.Value.Run3 };

      SkiTime[] sortedRuns = runs.OrderBy(run => run.TotalSeconds).ToArray();

      racer.Value.FinalTime = sortedRuns[0];

    }
  }


  protected override void OnInitialized() => FromJson();




}
